# 线性映射与矩阵方程的几何结构解析

$$
\begin{aligned}
 A: \mathbb{R}^n & \longrightarrow \mathbb{R}^m \\
 \text{domain}, &\text{codomain} \\
 \mathbb{R}^n = \mathrm{Null}(A) \oplus \mathrm{Null}(A)^\perp,& \quad \mathbb{R}^m = \mathrm{Col}(A) \oplus \mathrm{Col}(A)^\perp
\end{aligned}
$$

其中
$$
\dim(\mathrm{Null}(A)^\perp)=\dim(\mathrm{Col}(A))=\mathrm{rank}(A),\quad 
\mathrm{rank}(A)+\mathrm{nullity}(A)=n.
$$

线性代数的基本行列空间定理（Fundamental Theorem of Linear Algebra）进一步扩展了这些划分，引入四个基本子空间：列空间 $Col(A)$（或 $C(A)$）、零空间 $Null(A)$（或 $N(A)$）、行空间 $Row(A)$（或 $R(A)$，等价于 $Null(A)^\perp$ 或 $C(A^T)$）、左零空间 $Null(A^T)$（或 $N(A^T)$，等价于 $Col(A)^\perp$）。这些子空间在欧几里德空间中是正交补，确保分解的唯一性和正交性。

## 1. 两个空间与矩阵映射

线性方程组
$$
A x = b
$$
本质是一个线性变换
$$
A:\ \mathbb{R}^n \longrightarrow \mathbb{R}^m
$$
**输入空间**（或称定义域，domain）是 $\mathbb{R}^n$，所有 $n$ 维向量的集合。线性变换从这里“输入”向量。
**输出空间**（或称目标空间，codomain）是 $\mathbb{R}^m$，所有 $m$ 维向量的集合。线性变换在这里“输出”结果。

矩阵 $A$ 是 $m \times n$ 的，表示从输入空间到输出空间的映射。其秩 $r = \mathrm{rank}(A)$ 决定了映射的有效维度。

## 2. 输入空间的结构划分

输入空间 $\mathbb{R}^n$ 被分解为两个正交子空间：零空间和其正交补。这些对应于基本子空间中的 Null(A) 和 Row(A)。

1. **零空间**
$$
\mathrm{Null}(A) = \{x \in \mathbb{R}^n \mid A x = 0\}
$$
 - 属于这里的所有输入向量映射到输出空间的 **零向量**（信息丢失方向）。
 - 维数： $\mathrm{nullity}(A) = n - r$。
 - 几何意义：表示线性变换的核（kernel），其中向量被“压缩”到零。

2. **零空间的正交补**
 $$
 \mathrm{Null}(A)^\perp = \mathrm{Row}(A) = C(A^T)
 $$
 - 与零空间方向垂直。
 - 在这个子空间中的输入，**不会被映射成零**（除非本身是 0），并且经 $A$ 映射会精确张成输出空间中的 **列空间 Col(A)**。
 - 这个映射 $A: \mathrm{Null}(A)^\perp \to \mathrm{Col}(A)$ 是一个线性同构（isomorphism）：单射（因为 $\ker(A|_{\mathrm{Null}(A)^\perp}) = \{\mathbf{0}\}$）且满射（维度均为 $r$）。
 - 维数： $r$。
 - 几何意义：这是输入空间中“有效”或“信息保留”的部分，产生非零输出。

**输入空间正交分解**：
$$
\mathbb{R}^n = \mathrm{Null}(A) \ \oplus\ \mathrm{Null}(A)^\perp
$$
每个输入向量都可以唯一写成：
$$
x = x_{\perp} + x_{\mathrm{null}}
$$
其中 $x_{\perp}\in \mathrm{Null}(A)^\perp$ ， $x_{\mathrm{null}}\in\mathrm{Null}(A)$。
正交性：在标准内积下，$\mathbf{u} \cdot \mathbf{v} = 0$ 对于任意 $\mathbf{u} \in \mathrm{Null}(A)^\perp$ 和 $\mathbf{v} \in \mathrm{Null}(A)$。

## 3. 输出空间的结构划分

输出空间 $\mathbb{R}^m$ 类似地被分解为列空间和其正交补，对应于 Col(A) 和 Null(A^T)。

1. **列空间**
 $$
 \mathrm{Col}(A) = \{Ax \mid x\in\mathbb{R}^n\}
 $$
 - 又称**值域**（range/image），是线性变换的像。
 - 是所有方程右端 $b$ 可能出现的集合（有解的 $b$）。
 - 维数： $r$。
 - 由 $A$ 的列向量线性组合生成。

2. **列空间的正交补**
 $$
 \mathrm{Col}(A)^\perp = \mathrm{Null}(A^T) = \{y \in \mathbb{R}^m \mid A^T y = 0\}
 $$
 - 包含所有与 $\mathrm{Col}(A)$ 垂直的向量 $b$。
 - 如果 $b$ 有这部分分量，那么 $Ax = b$ 无解（除非这一部分全为零）。
 - 维数： $m - r$。
 - 几何意义：表示“不可达”方向，导致方程无解。

**输出空间正交分解**：
$$
\mathbb{R}^m = \mathrm{Col}(A) \ \oplus\ \mathrm{Col}(A)^\perp
$$
每个输出向量 $\mathbf{b}$ 可以唯一写成 $\mathbf{b} = \mathbf{b}_c + \mathbf{b}_n$，其中 $\mathbf{b}_c \in \mathrm{Col}(A)$，$\mathbf{b}_n \in \mathrm{Col}(A)^\perp$。
正交性：在标准内积下，$\mathrm{Col}(A) \perp \mathrm{Col}(A)^\perp$。

## 4. 维数关系总结（Rank–Nullity 定理的对称体现）

设 $r = \mathrm{rank}(A)$ ，则有：

| 所在空间                | 子空间                                       | 维数    | 关系式          |
| ----------------------- | -------------------------------------------- | ------- | --------------- |
| 输入空间 $\mathbb{R}^n$ | $\mathrm{Null}(A)$                           | $n - r$ | $n = (n-r) + r$ |
|                         | $\mathrm{Null}(A)^\perp = \mathrm{Row}(A)$   | $r$     |                 |
| 输出空间 $\mathbb{R}^m$ | $\mathrm{Col}(A)$                            | $r$     | $m = r + (m-r)$ |
|                         | $\mathrm{Null}(A^T) = \mathrm{Col}(A)^\perp$ | $m - r$ |                 |

**秩–零化度公式**：
$$
\boxed{
\begin{aligned}
&\mathrm{rank}(A) + \mathrm{nullity}(A) = n \\
&\mathrm{rank}(A) + \mathrm{nullity}(A^T) = m
\end{aligned}
}
$$
这些公式体现了行列空间的维度等价：$\mathrm{rank}(A) = \mathrm{rank}(A^T)$。

使用奇异值分解（SVD） $A = U \Sigma V^T$ 可以明确这些基：
- $\mathrm{Row}(A)$ 由 $V$ 的前 $r$ 列生成。
- $\mathrm{Null}(A)$ 由 $V$ 的后 $n-r$ 列生成。
- $\mathrm{Col}(A)$ 由 $U$ 的前 $r$ 列生成。
- $\mathrm{Null}(A^T)$ 由 $U$ 的后 $m-r$ 列生成。
这些基是正交的，奇异值 $\Sigma$ 的非零部分确保了 $\mathrm{Row}(A)$ 到 $\mathrm{Col}(A)$ 的同构映射。

## 5. 解集的整体几何结构

对于任意 $b\in\mathbb{R}^m$ ：

- **若** $b \in \mathrm{Col}(A)$ ，则方程有解：
  所有解形成一个仿射子空间：
 $$
 \{x_{\perp} + x_{\mathrm{null}} \mid x_{\perp} \text{是使 } Ax=b \text{ 的某个解},\ x_{\mathrm{null}}\in\mathrm{Null}(A)\}
 $$
  即 **所有解 = 任一解 + 零空间 Null(A)**。
  其中 $x_{\perp} \in \mathrm{Null}(A)^\perp$ 是唯一的（由于同构）。

- **若** $b \notin \mathrm{Col}(A)$ ，则无解：
  最接近的解为最小二乘解（把 $b$ 投影到 $\mathrm{Col}(A)$ 上），即求 $\min \|Ax - b\|^2$，其解在 $\mathrm{Null}(A)^\perp$ 中。

## 6. 关键对称性

- 输入空间的 $\mathrm{Null}(A)$ 映射成 0（信息丢失方向）。
- 输入空间的 $\mathrm{Null}(A)^\perp$ 映射到输出空间的 $\mathrm{Col}(A)$ （信息保留方向，一一对应）。
- 输出空间的 $\mathrm{Col}(A)^\perp$ 是 **无解原因所在** 的方向。
- 对称性：转置矩阵 $A^T$ 交换了输入/输出角色，但保持了维度关系。

## 7. 总结（结构层面）

- **输入空间的分解**：
$$
\mathbb{R}^n = \mathrm{Null}(A) \oplus \mathrm{Null}(A)^\perp
$$
- $\mathrm{Null}(A)$ → 映射为 0。
- $\mathrm{Null}(A)^\perp = \mathrm{Row}(A)$ → 一一对应到 $\mathrm{Col}(A)$。

- **输出空间的分解**：
$$
\mathbb{R}^m = \mathrm{Col}(A) \oplus \mathrm{Col}(A)^\perp
$$
- $\mathrm{Col}(A)$ = 实际可到达的 $b$。
- $\mathrm{Col}(A)^\perp = \mathrm{Null}(A^T)$ = 无法到达的方向（会造成无解）。

- **整个解集的结构**：
  先在输出空间检查 $b$ 是否在 $\mathrm{Col}(A)$，
  若在，则输入空间的所有解是“某个 $\mathrm{Null}(A)^\perp$（即 $\mathrm{Row}(A)$）中的向量”加上整个 $\mathrm{Null}(A)$ 子空间。

## 8. 实例运用

我们用矩阵
$$
A =
\begin{bmatrix}
1 & 2 & 1 \\
2 & 4 & 2
\end{bmatrix}
$$
来具体演示上述空间分解与几何结构。

### 1. 基本数据

- $A$ 是 $2\times 3$ 矩阵，$m=2, n=3$。
- 第二行是第一行的 $2$ 倍，所以 $\mathrm{rank}(A) = 1$。

由 Rank–Nullity 定理：

- $\mathrm{nullity}(A) = n - r = 3 - 1 = 2$。
- $\mathrm{nullity}(A^T) = m - r = 2 - 1 = 1$。



### 2. 四个基本子空间

1. **行空间**
   - 取非零行： $[1,\,2,\,1]$。
   - $\mathrm{Row}(A) = \mathrm{span}\{(1,2,1)\} \subset \mathbb{R}^3$。
   - 维数 $= r = 1$。

2. **零空间**
   解 $Ax = 0$：
   $$
   \begin{cases}
   x_1 + 2x_2 + x_3 = 0 \\
   2x_1 + 4x_2 + 2x_3 = 0
   \end{cases}
   \quad\Rightarrow\quad
   x_1 = -2x_2 - x_3
   $$
   依自由变量 $s,t$ 参数化：
   $$
   x = s(-2,\,1,\,0) + t(-1,\,0,\,1)
   $$
   所以：
   $$
   \mathrm{Null}(A) = \mathrm{span}\{(-2,1,0), (-1,0,1)\}, \quad \dim = 2。
   $$
   $\mathrm{Null}(A) \perp \mathrm{Row}(A)$。

3. **列空间**
   - $A$ 的列向量： $c_1 = (1,2)^T$, $c_2=(2,4)^T$, $c_3=(1,2)^T$。
     可以看出 $c_2=2c_1$, $c_3=c_1$，所以列空间是一维的：
     $$
     \mathrm{Col}(A) = \mathrm{span}\{(1,2)\},\quad \dim = 1。
     $$

4. **左零空间**（$\mathrm{Null}(A^T)$）
   解 $A^T y = 0$：
$$
\begin{bmatrix}
1 & 2 \\
2 & 4 \\
1 & 2
\end{bmatrix}
\begin{bmatrix}
y_1 \\ y_2
\end{bmatrix}
=
\begin{bmatrix}
y_1 + 2y_2 \\
2y_1 + 4y_2 \\
y_1 + 2y_2
\end{bmatrix}
= 0
$$
得 $y_1 + 2y_2 = 0$，解为 $y = (-2,1)t$：

$$
\mathrm{Null}(A^T) = \mathrm{span}\{(-2,1)\}, \quad \dim = 1。
$$

   它与 $\mathrm{Col}(A)$ 正交于 $\mathbb{R}^2$。


### 3. 空间分解总结

- **输入空间**
$$
\mathbb{R}^3 = \mathrm{Null}(A) \oplus \mathrm{Row}(A)
$$
$$
\mathrm{Null}(A) = \mathrm{span}\{(-2,1,0), (-1,0,1)\},\quad \mathrm{Row}(A) = \mathrm{span}\{(1,2,1)\}
$$

- **输出空间**
$$
\mathbb{R}^2 = \mathrm{Col}(A) \oplus \mathrm{Null}(A^T)
$$
$$
\mathrm{Col}(A) = \mathrm{span}\{(1,2)\},\quad \mathrm{Null}(A^T) = \mathrm{span}\{(-2,1)\}
$$

维数匹配：
- $\dim \mathrm{Row}(A) = \dim \mathrm{Col}(A) = r = 1$
- $\dim \mathrm{Null}(A) = 2$, $\dim \mathrm{Null}(A^T) = 1$

### 4. 解的几何意义

- 对于 $b$ 在 $\mathrm{Col}(A)$ 中，例如 $b=(3,6)$，方程 $Ax = b$ 有解。
  一般解：
  $$
  x = x_{\perp} + s(-2,1,0) + t(-1,0,1)
  $$
  其中 $x_{\perp} \in \mathrm{Row}(A)$ 是唯一的，$s,t \in \mathbb{R}$ 给出零空间部分。

- 对于 $b$ 不在 $\mathrm{Col}(A)$，如 $b=(1,0)$，无解。
  最小二乘解为将 $b$ 投影到 $\mathrm{Col}(A)$ 上，再反推出 $x_{\perp}$。

