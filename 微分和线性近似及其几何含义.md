# 微分用于线性近似即其几何含义

## 1 一元微分

### 1.1 导数的定义

设 \( f(x) \) 是一个定义在某开区间上的实值函数，且在点 \( x_0 \) 处可导。其导数 \( f'(x_0) \) 定义为极限形式：

\[
f'(x_0) = \lim_{h \to 0} \frac{f(x_0 + h) - f(x_0)}{h}
\]

此定义描述了函数在 \( x_0 \) 处的局部变化率，前提是该极限存在。



### 1.2 函数增量的表示

对于充分小的增量 \( h \)，函数在 \( x_0 \) 处的增量 \( \Delta y \) 定义为：

\[
\Delta y = f(x_0 + h) - f(x_0)
\]

根据导数的定义，当 \( h \to 0 \) 时，函数增量可近似表示为：

\[
\Delta y = f'(x_0) h + o(h)
\]

其中，\( o(h) \) 是一个高阶无穷小量，满足：

\[
\lim_{h \to 0} \frac{o(h)}{h} = 0
\]

这表明，当 \( h \) 趋于零时，\( \Delta y \) 与线性项 \( f'(x_0) h \) 之间的差值相对于 \( h \) 本身更快地趋于零。因此，若令 \( \Delta x = h \)，则：

\[
\Delta y = f'(x_0) \Delta x + o(\Delta x)
\]

此表达式可分解为：

\[
\Delta y = \underbrace{f'(x_0) \cdot \Delta x}_{\text{线性主部}} + \underbrace{o(\Delta x)}_{\text{高阶无穷小项}}
\]



### 1.3 微分的定义

函数在 \( x_0 \) 处的**微分** \( dy \) 定义为线性主部：

\[
dy = f'(x_0) \cdot \Delta x
\]

结合前述增量表达式，我们有：

\[
\Delta y = dy + o(\Delta x) = f'(x_0) \cdot \Delta x + o(\Delta x)
\]

微分 \( dy \) 表示函数在 \( x_0 \) 处沿切线方向的线性增量，而 \( o(\Delta x) \) 则代表非线性部分的误差。



### 1.4 切线方程与线性近似

从几何角度，微分对应于函数在 \( x_0 \) 处的切线上的增量。函数在 \( x_0 \) 处的切线方程为：

\[
y - f(x_0) = f'(x_0) (x - x_0)
\]

基于此切线方程，我们可以得到函数 \( f(x) \) 在 \( x_0 \) 附近的线性近似：

\[
f(x) \approx f(x_0) + f'(x_0) (x - x_0)
\]

若令 \( x = x_0 + h \)（即 \( h = x - x_0 \)），则等价形式为：

\[
f(x_0 + h) \approx f(x_0) + f'(x_0) h
\]

然而，这种线性近似仅在 \( h \) 充分小时有效，且精度有限，因为它忽略了 \( o(\Delta x) \) 中的高阶项。



为了更精确地描述函数在 \( x_0 \) 附近的局部行为，需要引入高阶导数进行修正。这自然引出了泰勒公式，通过高阶项对函数进行多项式近似，后续分析将进一步展开。



### 1.5 Taylor公式引入


在线性近似中，我们利用函数在一点的导数（即一阶信息）来估计函数在该点附近的取值。然而，为了更精确地刻画函数的局部行为，我们可以进一步引入函数的高阶导数，构造出**更高阶的近似表达式**。

设函数 \( f(x) \) 在某开区间内具有 \( n \) 阶连续导数，记 \( h = x - x_0 \)，则 \( f(x) \) 在点 \( x_0 \) 附近可展开为：

\[
f(x) = f(x_0) + f'(x_0)h + \frac{f''(x_0)}{2!}h^2 + \cdots + \frac{f^{(n)}(x_0)}{n!}h^n + R_n(h)
\]

其中 \( R_n(h) \) 为**余项**，表示高阶近似的误差项，具体形式依赖于所采用的余项形式（如拉格朗日型、皮亚诺型、积分型等）。  
最常见的为**拉格朗日余项**，其形式为：

\[
R_n(h) = \frac{f^{(n+1)}(\xi)}{(n+1)!}h^{n+1}, \quad \text{其中} \ \xi \in (x_0, x)
\]

当 \( h \to 0 \) 时，\( R_n(h) \to 0 \)，因此前 \( n \) 项构成函数在 \( x_0 \) 附近的高阶近似，称为**泰勒多项式（Taylor polynomial）**：

\[
T_n(x) = \sum_{k=0}^{n} \frac{f^{(k)}(x_0)}{k!}(x - x_0)^k
\]

特别地，\( n = 1 \) 时，Taylor 多项式即为线性近似：

\[
f(x) \approx f(x_0) + f'(x_0)(x - x_0)
\]

这正是前面微分所提供的**一阶逼近**。因此，可以将微分视为 Taylor 展开在一阶截断时所保留的主导部分。

这也恰好是Lagrange中值定理的形式:

\[
f(b) - f(a) = f'(\xi)(b - a)
\]

因此这类思想都是用线性量(或更精确一步的使用多项式)去描述函数的局部行为。

## 2 多元函数

### 2.1 偏导数与全微分

#### **偏导数**

对于多元函数 \( f: \mathbb{R}^n \to \mathbb{R} \)，设点 \( \mathbf{x}_0 = (x_{01}, x_{02}, \dots, x_{0n}) \)。函数关于第 \( i \) 个变量的偏导数定义为：

\[
\frac{\partial f}{\partial x_i}(\mathbf{x}_0) = \lim_{h \to 0} \frac{f(x_{01}, \dots, x_{0i} + h, \dots, x_{0n}) - f(\mathbf{x}_0)}{h}
\]

偏导数表示函数沿 \( x_i \)-轴方向的变化率。

**显然，每一个维度增量的叠加即整体增量，即全微分是所有维度的偏微分求和**

#### **全微分**

若 \( f \) 在 \( \mathbf{x}_0 \) 处对所有变量均可偏导，则当自变量增量 \( \Delta \mathbf{x} = (\Delta x_1, \dots, \Delta x_n) \) 很小时，函数增量 \( \Delta f = f(\mathbf{x}_0 + \Delta \mathbf{x}) - f(\mathbf{x}_0) \) 可近似为：

\[
\Delta f \approx \sum_{i=1}^{n} \frac{\partial f}{\partial x_i}(\mathbf{x}_0) \Delta x_i
\]

这一线性近似称为**全微分**，记为：

\[
df = \sum_{i=1}^{n} \frac{\partial f}{\partial x_i}(\mathbf{x}_0) \, dx_i
\]

#### **线性近似与几何含义**

全微分提供了函数的线性近似：

\[
f(\mathbf{x}_0 + \Delta \mathbf{x}) \approx f(\mathbf{x}_0) + \sum_{i=1}^{n} \frac{\partial f}{\partial x_i}(\mathbf{x}_0) \Delta x_i
\]

几何上，这对应于函数图形在 \( \mathbf{x}_0 \) 处的**切超平面**，类似于一元函数的切线。

---

### 2.2 方向导数与梯度

#### **方向导数**

多元函数不仅沿坐标轴变化，我们还关心沿任意方向的变化率。设 \( \mathbf{u} = (u_1, \dots, u_n) \) 为单位向量（\( \|\mathbf{u}\| = 1 \)），方向导数定义为：

\[
\frac{\partial f}{\partial \mathbf{u}}(\mathbf{x}_0) = \lim_{h \to 0} \frac{f(\mathbf{x}_0 + h \mathbf{u}) - f(\mathbf{x}_0)}{h}
\]

它表示函数沿 \( \mathbf{u} \) 方向的变化率。

**现在我们关系函数沿哪个方向的变化最大率最大，即求沿哪个方向的方向导数最大。**

\[
\underset{\|\mathbf{u}\|=1}{\max}\;D_{\mathbf{u}}f(\mathbf{x}_0).
\]


\[
\begin{aligned}
D_{\mathbf{u}}f(\mathbf{x}_0)
&:= \lim_{h\to 0}\frac{f(\mathbf{x}_0 + h\mathbf{u}) - f(\mathbf{x}_0)}{h}, 
\quad \|\mathbf{u}\|=1, \\[0.5em]
&= \sum_{i=1}^{n} \frac{\partial f}{\partial x_i}(\mathbf{x}_0)\,u_i 
\\[0.5em]
&= \nabla f(\mathbf{x}_0)\cdot \mathbf{u}, \\[0.5em]
&= \|\nabla f(\mathbf{x}_0)\|\,\|\mathbf{u}\|\,\cos\theta 
\;=\;\|\nabla f(\mathbf{x}_0)\|\cos\theta,
\end{aligned}
\]
其中 \(\theta\) 是 \(\nabla f(\mathbf{x}_0)\) 与 \(\mathbf{u}\) 之间的夹角。


其中$x_0 = (x_{01}, x_{02}, \dots, x_{0n})$

发现当且仅当$\vec{u}$和$\nabla f(\vec x_0)$同方向时，方向导数达到最大值。

故我们将$\nabla f(\vec x_0)$称为梯度，记为

$$\nabla f(\vec x_0) = \left(\frac{\partial f}{\partial x_1}(\vec x_0),\dots,\frac{\partial f}{\partial x_n}(\vec x_0)\right)$$

对于 \(f:\mathbb{R}^n\to\mathbb{R}\)，若在 \(\mathbf{x}_0\) 可微，则

\[
df(\mathbf{x}_0)
= \sum_{i=1}^n \frac{\partial f}{\partial x_i}(\mathbf{x}_0)\,dx_i
= \nabla f(\mathbf{x}_0)\cdot d\mathbf{x}
\]

