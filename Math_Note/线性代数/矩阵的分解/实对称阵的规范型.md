

## 定理与引理（声明）

**定理 1（实对称矩阵的正交对角化 / 谱定理）**
若 \( A \in \mathbb{R}^{n \times n} \) 且 \( A^T=A \)，则存在正交矩阵 \( Q \in O(n) \) 和对角矩阵 \( D = \operatorname{diag}(\lambda_1, \dots, \lambda_n) \)（实数）使得

\[
A = Q D Q^T,
\]

即 \( Q^T A Q = D \)。这里 \( (\lambda_i) \) 为 \( A \) 的实特征值。

（谱定理的标准证明可用实特征向量正交化或代数方法，此处不赘；这是常用基本事实。）

**定义（合同变换、二次型）**
对称矩阵 \( A \) 对应二次型 \( f(x) = x^T A x \)。若存在可逆矩阵 \( P \) 使得 \( B = P^T A P \)，则称 \( A \) 与 \( B \) 通过合同变换等价（congruent）。合同变换即在变量代换 \( x = P z \) 下的变换，因为

\[
x^T A x = z^T (P^T A P) z.
\]

**引理（惯性数的算术意义）**
对称矩阵 \( A \) 的正惯性数 \( p \) 定义为：在所有子空间 \( V \subseteq \mathbb R^n \) 中，使得 \( x^T A x > 0 \) 对所有非零 \( x \in V \) 成立的最大维数；同理定义负惯性数 \( q \)。零惯性数为 \( r=n-p-q \)。这一定义等价于在某对角形式下正对角元的个数、负对角元的个数与零的个数。

---

## 目标（Sylvester 惯性定理）

**要证明：** 对任意实对称矩阵 \( A \in \mathbb R^{n \times n} \)，存在可逆矩阵 \( P \) 使得

\[
P^T A P = \begin{pmatrix} I_p & 0 & 0 \\ 0 & -I_q & 0 \\ 0 & 0 & 0_r \end{pmatrix},
\]

其中 \( p, q, r \ge 0 \), \( p+q+r=n \)。且 \( p, q, r \) 仅由 \( A \) 决定（不依赖于具体的合同变换），即为 \( A \) 的惯性（signature）。

我们给出两种常见的证明思路：一种利用谱定理（更代数化、直接），另一种构造性（完成平方 / Gram-Schmidt 风格），并证明惯性数不变性。

---

## 证明

1. 由谱定理，存在正交 \( Q \) 使得 \( Q^T A Q = D = \operatorname{diag}(\lambda_1, \dots, \lambda_n) \)。因此二次型在正交坐标 \( y = Q^T x \) 下为

   \[
   f(x) = x^T A x = y^T D y = \sum_{i=1}^n \lambda_i y_i^2.
   \]

   这一步完全成立且不需要额外假设。

2. 把 \( \lambda_i \) 按符号分组：重新排列索引，使前 \( p \) 个为正（\(\lambda_1, \dots, \lambda_p > 0\)），接着 \( q \) 个为负（\(\lambda_{p+1}, \dots, \lambda_{p+q} < 0\)），剩下 \( r = n-p-q \) 个为零（若存在）。于是

   \[
   y^T D y = \sum_{i=1}^p \lambda_i y_i^2 + \sum_{i=p+1}^{p+q} \lambda_i y_i^2 + \sum_{i=p+q+1}^{n} 0 \cdot y_i^2.
   \]

3. 对于每个非零 \( \lambda_i \)，作缩放变换令

   \[
   z_i = \sqrt{|\lambda_i|} y_i \quad\text{或等价地}\quad y_i = \frac{1}{\sqrt{|\lambda_i|}} z_i.
   \]

   用矩阵形式定义对角矩阵

   \[
   S = \operatorname{diag}\big( \tfrac{1}{\sqrt{|\lambda_1|}}, \dots, \tfrac{1}{\sqrt{|\lambda_{p+q}|}}, 1, \dots, 1 \big),
   \]

   其中对零特征值对应的因子保持为 1（或对零分量不做缩放并在构造时单独处理）。注意 \( S \) 对于 \(\lambda_i\neq0\) 是可逆的，若存在零特征值，则整体 \( S \) 不可逆（但我们实际上会只对非零部分构造可逆变换，然后把零部分并入末尾）。

4. 令 \( z = S^{-1} y \)（对非零部分），则

   \[
   y^T D y = z^T (S^T D S) z.
   \]

   直接计算对非零部分，

   \[
   S^T D S = \operatorname{diag}(\operatorname{sgn}(\lambda_1), \dots, \operatorname{sgn}(\lambda_{p+q}), 0, \dots, 0) = \operatorname{diag}(I_p, -I_q, 0_r).
   \]

   因此在变量 \( z \) 下，二次型写成所需的规范型。把这两个变换合并成单个合同变换：

   \[
   x = Q y = Q S z \quad\Longrightarrow\quad P := Q S
   \]

   （若 \( S \) 在零部分不可逆，可先把零部分单独留到末尾，并在定义 \( P \) 时用可逆部分扩展为可逆矩阵并添加单位块；具体构造见下一节）。于是得

   \[
   P^T A P = \operatorname{diag}(I_p, -I_q, 0_r).
   \]

   这完成了存在性的证明（即存在合同变换将 \( A \) 变为所述规范型）。



## 惯性的唯一性（不变性证明）

要说明 \( p, q, r \) 仅与 \( A \) 有关（不依赖于具体的合同变换），等价于说明：若存在可逆矩阵 \( P \) 使得

\[
P^T A P = \operatorname{diag}(I_{p_1}, -I_{q_1}, 0_{r_1})
\quad\text{且}\quad
Q^T A Q = \operatorname{diag}(I_{p_2}, -I_{q_2}, 0_{r_2}),
\]

则 \( p_1 = p_2, q_1 = q_2, r_1 = r_2 \).

证明要点（常见的两个证明途径）：

1. **极大正定子空间的维数不变**（从几何定义出发）：
   定义 \( p(A) \) 为所有子空间 \( V \subseteq \mathbb R^n \) 中使得 \( x^T A x > 0 \) 对非零 \( x \in V \) 成立的最大可能维数。容易证明 \( p(A) \) 等于任何规范型中正对角元的个数。若 \( B = P^T A P \)，任何使 \( x^T A x > 0 \) 的子空间 \( V \) 在变换 \( z = P^{-1} x \) 下对应于使 \( z^T B z > 0 \) 的子空间，维数保持不变。因此 \( p(A) = p(B) \)。同理对 \( q \)。这直接得出不变性。

2. **代数法（反证）**：若两种规范型的正对角元个数不同，可构造一个矛盾（例如在较小 \( p \) 的规范型中找出一个维数超过该 \( p \) 的正定子空间），从而矛盾。详见标准线性代数教材。

因此 \( p, q, r \) 是 \( A \) 的不变量（称为惯性）。这就是 **Sylvester 的惯性定理（Law of Inertia）**。

---

## 小结（把结论写成定理）

**Sylvester 惯性定理（最终形式）**
设 \( A \in \mathbb R^{n \times n} \) 为对称矩阵，则存在可逆矩阵 \( P \) 使得

\[
P^T A P = \begin{pmatrix} I_p & 0 & 0 \\ 0 & -I_q & 0 \\ 0 & 0 & 0_r \end{pmatrix}.
\]

而且 \( p, q, r \)（正、负、零的个数）是 \( A \) 的不变量，即对任意可逆 \( R \) 使得 \( R^T A R \) 为任意对角规范型时，该三元组相同。特别地，若 \( A \) 正定（即所有 \(\lambda_i > 0\)），则可以取 \( P \) 使得 \( P^T A P = I_n \)。

---

## 备注（与你的原推导对照）

* 你原推导的步骤 \( A = Q D Q^T \), 令 \( y = Q^T x \), 然后用 \( S = \operatorname{diag}(\frac{1}{\sqrt{\lambda_i}}) \) 把 \( y \) 归一化，最后得到 \( z^T I z \)，在**所有 \(\lambda_i > 0\)** 时是完全正确的（这是正定矩阵的特例）。
* 上面的严格证明说明了如何把一般情形（含负或零特征值）也统一处理，并说明了为什么最终一定得到带有 \(+1,-1,0\) 的规范型，且这些 \(+1,-1,0\) 的个数是矩阵本身（而非所选变换）的属性。

