# 分块矩阵（Block Matrix）总结

## 一、定义与记号

设矩阵
\[
A \in \mathbb{R}^{m\times n},
\]
按行列方向划分为子矩阵（块）：
\[
A =
\begin{bmatrix}
A_{11} & A_{12} & \cdots & A_{1q}\\
A_{21} & A_{22} & \cdots & A_{2q}\\
\vdots & \vdots & \ddots & \vdots\\
A_{p1} & A_{p2} & \cdots & A_{pq}
\end{bmatrix}.
\]
称每个子块 \(A_{ij}\) 为分块矩阵的“块元素”。常用记号：
- \(0\) 表示与上下文维度相容的零块；\(I\) 表示相容大小的单位块；
- 分块的合法性要求块的行列数匹配（例如同一行的块行数相同，同一列的块列数相同）。

## 二、基本运算规则

- 加法（块对齐）
\[
A=[A_{ij}],\ B=[B_{ij}],\ \text{同型分块}\ \Rightarrow\ 
A+B=[A_{ij}+B_{ij}].
\]

- 数乘
\[
kA=[\,kA_{ij}\,].
\]

- 乘法（分块乘法，维度匹配）
\[
C=AB=[C_{ik}],\quad C_{ik}=\sum_{j} A_{ij}B_{jk}.
\]
两块情形：
\[
A =
\begin{bmatrix}
A_{11} & A_{12}\\
A_{21} & A_{22}
\end{bmatrix},\quad
B =
\begin{bmatrix}
B_{11} & B_{12}\\
B_{21} & B_{22}
\end{bmatrix}
\Rightarrow
AB =
\begin{bmatrix}
A_{11}B_{11} + A_{12}B_{21} & A_{11}B_{12} + A_{12}B_{22}\\
A_{21}B_{11} + A_{22}B_{21} & A_{21}B_{12} + A_{22}B_{22}
\end{bmatrix}.
\]

## 三、特殊分块形式与性质

- 块对角矩阵
\[
A=\operatorname{diag}(A_1,\dots,A_k)=
\begin{bmatrix}
A_1 & 0 & \cdots & 0\\
0 & A_2 & \cdots & 0\\
\vdots & \vdots & \ddots & \vdots\\
0 & 0 & \cdots & A_k
\end{bmatrix}.
\]
性质（若每块可逆）：
\[
A^{-1}=\operatorname{diag}(A_1^{-1},\dots,A_k^{-1}),\quad
\det(A)=\prod_{i=1}^k \det(A_i),
\]
特征值为各对角块特征值的并集。

- 块上/下三角矩阵（以 2×2 为例）
\[
A=
\begin{bmatrix}
A_{11} & A_{12}\\
0 & A_{22}
\end{bmatrix}.
\]
若 \(A_{11},A_{22}\) 可逆，则
\[
A^{-1}=
\begin{bmatrix}
A_{11}^{-1} & -A_{11}^{-1}A_{12}A_{22}^{-1}\\
0 & A_{22}^{-1}
\end{bmatrix},\quad
\det(A)=\det(A_{11})\det(A_{22}).
\]

- 分块转置与共轭转置（2×2）
\[
\begin{bmatrix}
A & B\\
C & D
\end{bmatrix}^{\!\top}=
\begin{bmatrix}
A^{\top} & C^{\top}\\
B^{\top} & D^{\top}
\end{bmatrix},\qquad
\begin{bmatrix}
A & B\\
C & D
\end{bmatrix}^{\!*}=
\begin{bmatrix}
A^{*} & C^{*}\\
B^{*} & D^{*}
\end{bmatrix}.
\]

## 四、重要分块结论

- Schur 补与逆公式（2×2 分块）
\[
A=
\begin{bmatrix}
A_{11} & A_{12}\\
A_{21} & A_{22}
\end{bmatrix}.
\]
若 \(A_{11}\) 可逆，定义 Schur 补
\[
S=A_{22}-A_{21}A_{11}^{-1}A_{12},
\]
且若 \(S\) 可逆，则
\[
A^{-1}=
\begin{bmatrix}
A_{11}^{-1} + A_{11}^{-1}A_{12}S^{-1}A_{21}A_{11}^{-1} & -A_{11}^{-1}A_{12}S^{-1}\\[4pt]
-\,S^{-1}A_{21}A_{11}^{-1} & S^{-1}
\end{bmatrix}.
\]
对称公式：若 \(A_{22}\) 可逆，令
\[
T=A_{11}-A_{12}A_{22}^{-1}A_{21},
\]
且 \(T\) 可逆，则
\[
A^{-1}=
\begin{bmatrix}
T^{-1} & -T^{-1}A_{12}A_{22}^{-1}\\[4pt]
-\,A_{22}^{-1}A_{21}T^{-1} & A_{22}^{-1}+A_{22}^{-1}A_{21}T^{-1}A_{12}A_{22}^{-1}
\end{bmatrix}.
\]


- 上三角分块矩阵的逆
$$
\begin{bmatrix}
A & B\\
0 & D
\end{bmatrix}^{-1}=
\begin{bmatrix}
A^{-1} & -A^{-1} B D^{-1}\\
0 & D^{-1}
\end{bmatrix}
$$

$$\begin{bmatrix}
A & 0\\
C & D
\end{bmatrix}^{-1}=
\begin{bmatrix}
A^{-1} & 0\\
-D^{-1} C A^{-1} & D^{-1}
\end{bmatrix}.$$

- 行列式分块展开（可逆条件同上）
\[
\det(A)=\det(A_{11})\det\!\bigl(A_{22}-A_{21}A_{11}^{-1}A_{12}\bigr)
=\det(A_{22})\det\!\bigl(A_{11}-A_{12}A_{22}^{-1}A_{21}\bigr).
\]

- 分块三角行列式
\[
\det
\begin{bmatrix}
A & B\\
0 & D
\end{bmatrix}
=\det(A)\det(D),\qquad
\det
\begin{bmatrix}
A & 0\\
C & D
\end{bmatrix}
=\det(A)\det(D).
\]

- 分块迹
\[
\operatorname{tr}
\begin{bmatrix}
A & B\\
C & D
\end{bmatrix}
=\operatorname{tr}(A)+\operatorname{tr}(D).
\]

## 五、Kronecker 积与向量化

设 \(A\in\mathbb{R}^{n\times n},\,B\in\mathbb{R}^{m\times m}\)，则
\[
A\otimes B =
\begin{bmatrix}
a_{11}B & a_{12}B & \cdots & a_{1n}B\\
a_{21}B & a_{22}B & \cdots & a_{2n}B\\
\vdots & \vdots & \ddots & \vdots\\
a_{n1}B & a_{n2}B & \cdots & a_{nn}B
\end{bmatrix}.
\]
基本性质：
\[
(A\otimes B)(C\otimes D)=(AC)\otimes(BD),\quad
(A\otimes B)^{\top}=A^{\top}\otimes B^{\top},
\]
\[
\det(A\otimes B)=\det(A)^{m}\det(B)^{n},\quad
\operatorname{tr}(A\otimes B)=\operatorname{tr}(A)\operatorname{tr}(B).
\]
向量化恒等式（维度相容）：
\[
\mathrm{vec}(AXB)=(B^{\top}\otimes A)\,\mathrm{vec}(X).
\]

## 六、常用应用场景

- 大规模数值线性代数：块 LU/QR/Cholesky 分解、并行计算、缓存友好实现；
- 控制与状态空间：系统分块建模、Schur 补用于稳定性与 LMI；
- 信号与图像：Kronecker 结构加速、张量化建模；
- 矩阵恒等式证明：逆/行列式/相似变换的分块推导；
- 概率统计与机器学习：协方差/Gram 矩阵的块更新与消元。