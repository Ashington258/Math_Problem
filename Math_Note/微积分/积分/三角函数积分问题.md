# 三角函数积分问题

## 0 三角函数基础

1. **三角函数基础**

- 求导运算
- 三角恒等
- 两角合差
- 倍角 / 半角 / 降次公式
- 和差化积 / 积化和差
- 特殊公式：辅助角

### 0.0 求导运算

**三角函数基础关系**

$$
\sec x = \frac{1}{\cos x}, \quad 
\csc x = \frac{1}{\sin x}, \quad 
\cot x = \frac{1}{\tan x},
$$

$$
\tan x = \frac{\sin x}{\cos x}, \quad 
\cot x = \frac{\cos x}{\sin x}.
$$

**三角函数求导**

$$
\begin{aligned}
\frac{d}{dx}\sin x &= \cos x,  &\quad
\frac{d}{dx}\cos x &= -\sin x, \\[4pt]
\frac{d}{dx}\tan x &= \sec^2 x, &\quad
\frac{d}{dx}\cot x &= -\csc^2 x, \\[4pt]
\frac{d}{dx}\sec x &= \sec x \tan x, &\quad
\frac{d}{dx}\csc x &= -\csc x \cot x.
\end{aligned}
$$

**反三角函数求导**

$$
\begin{aligned}
\frac{d}{dx}\sin^{-1} x &= \frac{1}{\sqrt{1-x^2}}, &\quad
\frac{d}{dx}\cos^{-1} x &= -\frac{1}{\sqrt{1-x^2}}, \\[4pt]
\frac{d}{dx}\tan^{-1} x &= \frac{1}{1+x^2}, &\quad
\frac{d}{dx}\cot^{-1} x &= -\frac{1}{1+x^2}, \\[4pt]
\frac{d}{dx}\sec^{-1} x &= \frac{1}{|x|\sqrt{x^2-1}}, &\quad
\frac{d}{dx}\csc^{-1} x &= -\frac{1}{|x|\sqrt{x^2-1}}.
\end{aligned}
$$

### 0.1 三角恒等

$$
\begin{aligned}
\sin^2 x + \cos^2 x &= 1, \\[4pt]
\tan^2 x + 1 &= \sec^2 x, \\[4pt]
\cot^2 x + 1 &= \csc^2 x.
\end{aligned}
$$

### 0.2 两角合差

$$
\begin{aligned}
\sin(a\pm b) &= \sin a\,\cos b \;\pm\; \cos a\,\sin b, \\[4pt]
\cos(a\pm b) &= \cos a\,\cos b \;\mp\; \sin a\,\sin b, \\[4pt]
\tan(a\pm b) &= \frac{\tan a \;\pm\; \tan b}{1 \;\mp\; \tan a\,\tan b}.
\end{aligned}
$$

### 0.3 倍角 / 半角 / 降次

**倍角公式**

$$
\begin{aligned}
\sin2x &= 2\sin x\,\cos x, \\[4pt]
\cos2x &= \cos^2 x - \sin^2 x
       = 2\cos^2 x - 1
       = 1 - 2\sin^2 x, \\[4pt]
\tan2x &= \frac{2\tan x}{1 - \tan^2 x}.
\end{aligned}
$$

**半角公式**

$$
\begin{aligned}
\sin\frac{x}{2} &= \sqrt{\frac{1 - \cos x}{2}}, \\[4pt]
\cos\frac{x}{2} &= \sqrt{\frac{1 + \cos x}{2}}, \\[4pt]
\tan\frac{x}{2} &= \frac{\sin x}{1 + \cos x}
                = \frac{1 - \cos x}{\sin x}.
\end{aligned}
$$

**降次公式**

$$
\begin{aligned}
\sin^2 x &= \frac{1 - \cos2x}{2}, \\[4pt]
\cos^2 x &= \frac{1 + \cos2x}{2}, \\[4pt]
\tan^2 x &= \frac{1 - \cos2x}{1 + \cos2x}.
\end{aligned}
$$

### 0.4 和差化积 / 积化和差

#### 和差化积（Sum‑to‑Product）

$$
\boxed{
\begin{aligned}
\sin a + \sin b &= 2 \sin\!\Bigl(\frac{a+b}{2}\Bigr)\,\cos\!\Bigl(\frac{a-b}{2}\Bigr), \\[6pt]
\sin a - \sin b &= 2 \cos\!\Bigl(\frac{a+b}{2}\Bigr)\,\sin\!\Bigl(\frac{a-b}{2}\Bigr), \\[6pt]
\cos a + \cos b &= 2 \cos\!\Bigl(\frac{a+b}{2}\Bigr)\,\cos\!\Bigl(\frac{a-b}{2}\Bigr), \\[6pt]
\cos a - \cos b &= -2 \sin\!\Bigl(\frac{a+b}{2}\Bigr)\,\sin\!\Bigl(\frac{a-b}{2}\Bigr).
\end{aligned}
}
$$

#### 积化和差（Product‑to‑Sum）

$$
\boxed{
\begin{aligned}
\sin a\,\sin b &= \tfrac12\bigl[\cos(a-b)-\cos(a+b)\bigr], \\[6pt]
\cos a\,\cos b &= \tfrac12\bigl[\cos(a+b)+\cos(a-b)\bigr], \\[6pt]
\sin a\,\cos b &= \tfrac12\bigl[\sin(a+b)+\sin(a-b)\bigr], \\[6pt]
\cos a\,\sin b &= \tfrac12\bigl[\sin(a+b)-\sin(a-b)\bigr].
\end{aligned}
}
$$

#### 统一变量法

$$
\boxed{
\begin{aligned}
\sin(x+y)+\sin(x-y) &= 2\sin x\,\cos y, \\[6pt]
\sin(x+y)-\sin(x-y) &= 2\cos x\,\sin y, \\[6pt]
\cos(x+y)+\cos(x-y) &= 2\cos x\,\cos y, \\[6pt]
\cos(x+y)-\cos(x-y) &= -2\sin x\,\sin y.
\end{aligned}
}
$$

### 0.5 特殊公式：辅助角

$$
\begin{aligned}
a\sin x + b\cos x
&= \sqrt{a^2+b^2}\;\sin\!\bigl(x + \varphi\bigr) \\[8pt]
\text{其中}\quad
\varphi &\in \Bigl(-\tfrac{\pi}{2},\,\tfrac{\pi}{2}\Bigr),
\quad \tan\varphi = \frac{b}{a}.
\end{aligned}
$$

利用两角合差逆运用推导


设

$$
a\sin x + b\cos x = R\sin(x+\varphi).
$$

展开并比对系数：

$$
R\sin(x+\varphi)=R(\sin x\cos\varphi+\cos x\sin\varphi)
= (R\cos\varphi)\sin x + (R\sin\varphi)\cos x,
$$

故

$$
R\cos\varphi=a,\qquad R\sin\varphi=b.
$$

由此得到

$$
R=\sqrt{a^2+b^2},\qquad
\cos\varphi=\frac{a}{R},\ \ \sin\varphi=\frac{b}{R}.
$$

相位可用 atan2 表示，避免象限歧义：

$$
\varphi=\operatorname{atan2}(b,\ a).
$$

若必须用普通反正切，可写成分段（主值取在 $[-\pi,\pi]$ ）：

$$
\varphi=
\begin{cases}
\arctan\!\frac{b}{a}, & a>0,\\[4pt]
\arctan\!\frac{b}{a}+\pi, & a<0\ \text{且}\ b\ge 0,\\[4pt]
\arctan\!\frac{b}{a}-\pi, & a<0\ \text{且}\ b<0,\\[4pt]
\frac{\pi}{2}\,\mathrm{sgn}(b), & a=0,\ b\ne 0,\\[4pt]
\text{未定（任取）}, & a=b=0.
\end{cases}
$$

等价的余弦相位形式：
$$
a\sin x + b\cos x = R\cos(x-\delta),\quad
\delta=\operatorname{atan2}(a,\ b).
$$

## 1 不定积分

### 1.0 基本积分

$$
\boxed{
\begin{aligned}
\int \sin x\, dx &= -\cos x + C, \\[6pt]
\int \cos x\, dx &= \sin x + C, \\[6pt]
\int \sec x\, dx &= \ln|\sec x + \tan x| + C, \\[6pt]
\int \csc x\, dx &= \ln|\csc x - \cot x| + C, \\[6pt]
\int \tan x\, dx &= -\ln|\cos x| + C = \ln|\sec x| + C, \\[6pt]
\int \cot x\, dx &= \ln|\sin x| + C = -\ln|\csc x| + C,
\end{aligned}
}
$$

### 1.1 $P_mm(x)\sin x$ 的不定积分

$$
\boxed{
\int P_m(x)\sin x\, dx = \int P_m(x)\,d(\cos x) = -P_m(x)\cos x + \int P_m'(x)\cos x\, dx
}
$$

如此循环往复该过程可以降低多项式的次数。

- 原理
- $\sin x$ 求导/积分不会杂化式子
- $P_m(x)$ 通过分部积分法降低次数

这也从侧面说明了分部积分法的真实作用是通过求导运算来化简(这种化简是一种代数话过程)，例如 $\ln(x)$ ,反三角函数等通过求导运算直接转化成代数式。求导对于三角函数还有可能引入周期性从而实现对消。

### 1.2 三角分式积分

形如如下形式的三角分式积分，**若一个三角函数分式的分子是分母及其导数的线性组合，则原积分可拆分为易积的两个部分：一个对数函数、一个线性函数。**
$$
\int\frac{\sin x - \cos x}{\sin x + 2\cos x}dx
$$

给出更一般的情形：

设函数为：

$$
f(x) = \frac{N(x)}{D(x)} = \frac{a\sin x + b\cos x}{c\sin x + d\cos x}
$$

那么只要分子 $N(x)$ 可以写成：

$$
N(x) = \alpha D'(x) + \beta D(x)
$$

即

$$
a\sin x + b\cos x = \alpha(c\cos x - d\sin x) + \beta(c\sin x + d\cos x)
$$

则：

$$
\int \frac{N(x)}{D(x)}\,dx = \alpha \ln|D(x)| + \beta x + C
$$

这个技巧的核心来自两个函数的基本不定积分公式：

- $\displaystyle \int \frac{f'(x)}{f(x)} dx = \ln|f(x)| + C$ 
- $\displaystyle \int 1\,dx = x + C$ 

所以，如果你能把被积函数写成：

$$
\frac{\alpha f'(x) + \beta f(x)}{f(x)} = \alpha \frac{f'(x)}{f(x)} + \beta
$$

则就可以直接积分为：

$$
\alpha \ln|f(x)| + \beta x + C
$$

在三角函数中，像 $D = c\sin x + d\cos x$ 这类函数，其导数也仍然是三角函数（即保闭），因此我们**可以构造性地拆解**出线性组合。

$$
\boxed{
\text{若分子是分母及其导数的线性组合，积分可被结构性地拆分为}~\ln|f(x)|~\text{与常数项。}
}
$$

**这本质是一种结构性的凑微分**

### 1.3 高次三角函数的积分(奇次凑微分)

对于高次三角函数的积分，特别是奇次项的积分，我们可以利用分部积分法和奇次凑微分的思路来进行处理。

例如，对于 $\int \sin^3 x\, dx$ ，我们可以先将其转化为：

$$
\begin{aligned}
\int \sin^3 x \, dx &= \int \sin x \cdot \sin^2 x \, dx \\
&= -\int \sin^2 x \, d(\cos x) \\
&= -\int (1 - \cos^2 x) \, d(\cos x) \\
&= \text{多项式积分}
\end{aligned}
$$

- 原理
- 奇次项拆分为一次和偶次项的乘积
- 偶次项可以通过 $\sin^2 x+ \cos^2 x = 1$ 转化为多项式积分

如果遇到偶次三角积分问题，我们可以将其转化成奇次(通过降次公式)，再转化成多项式积分问题。

### 1.4 分母高次

形如一下的积分:

$$
\int\frac{1}{\cos^4x\cos^2x}dx
$$

$$
\int\frac{1}{\sin^2x\cos^3x}dx
$$

**利用 $\sin^2 x + \cos^2 x = 1$ 从而拆分成简单形式的三角函数积分**

$$
\begin{aligned}
   \int\frac{1}{\sin^4x\cos^2x}dx &=\int \frac{\sin^2 x+\cos^2x}{\sin^4x\cos^2x}dx\\
   &=\int \frac{\sin^2 x}{\sin^4x\cos^2x}dx + \int \frac{\cos^2 x}{\sin^4x\cos^2x}dx\\
   &=\int \frac{1}{\sin^2x\cos^2x}dx + \int \frac{1}{\sin^4x}dx\\
   &= \tan x -\cot x+\int\csc^4xdx\\
   &=\cdots -\int[\cot^2x+1]d(\cot x)
\end{aligned}
$$

### 1.5 分母带非线性，带偏移量

形如:

$$
\int\frac{1}{1+\sin x}dx
$$

**想办法将分母转化成单项从而使用之前的方法**

**熟练使用各类三角恒等，各种三角公式**
e.g.1

$$
\begin{aligned}
   \int\frac{1}{1+\sin x}dx &= \int\frac{1-\sin x}{1-\sin^2x}dx\\
   &= \int\frac{1-\sin x}{\cos^2x}dx\\
   &= \int\sec^2xdx - \int\sec^2x\tan xdx\\
   &= \tan x - \ln|\sec x + \tan x| + C
\end{aligned}
$$

e.g.2(辅助角公式)

$$
\begin{aligned}
   \int\frac{1}{\sqrt{2}+\sin x+\cos x}dx &= \int\frac{1}{\sqrt{2}+\sqrt{2}\sin(x+\frac{\pi}{4})}dx\\
   &= \frac{1}{\sqrt{2}}\int\frac{1}{1+\sin(t)}dx\\
\end{aligned}
$$

### 1.6 Weierstrass 代换

Weierstrass 代换是将三角函数转化为代数函数的一种方法，特别适用于处理复杂的三角函数积分。

将变量代换为：

$$
t = \tan\frac{x}{2}
$$

然后使用恒等式：

$$
\sin x = \frac{2t}{1 + t^2}, \quad \cos x = \frac{1 - t^2}{1 + t^2}, \quad dx = \frac{2}{1 + t^2}dt
$$

## 2 定积分

定积分首先继承三角函不定积分的所有结论，以及三角函数的所有公式。
但是在特定的定积分区间 $[0, \pi/2]$ 内，三角函数定积分有了更多的性质。

可以。统一空格、微分写成 d、分数用 $\pi/2$ ，并用对齐环境：

$$
\begin{aligned}
\int_{0}^{2\pi} f(\sin x)\,\mathrm{d}x
&= \int_{0}^{\pi}\!\bigl[f(\sin x)+f(-\sin x)\bigr]\,\mathrm{d}x \\
&= 2\int_{0}^{\pi} f_e(\sin x)\,\mathrm{d}x
= 4\int_{0}^{\pi/2} f_e(\sin x)\,\mathrm{d}x
\end{aligned}
$$

$$
\int_{0}^{\pi} f(\sin x)\,\mathrm{d}x
= 2\int_{0}^{\pi/2} f(\sin x)\,\mathrm{d}x
$$

$$
\int_{0}^{\pi} x\,f(\sin x)\,\mathrm{d}x
= \frac{\pi}{2}\int_{0}^{\pi} f(\sin x)\,\mathrm{d}x
= \pi \int_{0}^{\pi/2} f(\sin x)\,\mathrm{d}x
$$

**Wallis 公式**

$$
\int_0^{\frac{\pi}{2}} \sin^n x \, dx = \int_0^{\frac{\pi}{2}} \cos^n x \, dx =
\begin{cases}
\dfrac{(n-1)(n-3)\cdots 1}{n(n-2)\cdots 2} \cdot \dfrac{\pi}{2}, & n\ \text{为偶数} \\
\dfrac{(n-1)(n-3)\cdots 2}{n(n-2)\cdots 1}, & n\ \text{为奇数}
\end{cases}
$$

或者统一地表示为（适用于 $n > 0$ ）：

$$
\int_0^{\frac{\pi}{2}} \sin^n x \, dx = \int_0^{\frac{\pi}{2}} \cos^n x \, dx = \frac{\sqrt{\pi}\,\Gamma\left(\frac{n+1}{2}\right)}{2\,\Gamma\left(\frac{n}{2} + 1\right)}
$$

**对称代换**
$$x = \frac{\pi}{2} - t$$

**e.g.1**

$$
x = \frac{\pi}{2} - t \Rightarrow dx = -dt
$$

当 $x = 0 \Rightarrow t = \frac{\pi}{2}$ ，
当 $x = \frac{\pi}{2} \Rightarrow t = 0$ ，
所以积分区间变为：

$$
\int_0^{\frac{\pi}{2}} \frac{\sin x}{\sin x + \cos x} dx = \int_{\frac{\pi}{2}}^0 \frac{\sin\left( \frac{\pi}{2} - t \right)}{\sin\left( \frac{\pi}{2} - t \right) + \cos\left( \frac{\pi}{2} - t \right)} (-dt)
$$

因为 $\sin\left( \frac{\pi}{2} - t \right) = \cos t$ ，
 $\cos\left( \frac{\pi}{2} - t \right) = \sin t$ ，

所以变成：

$$
\int_0^{\frac{\pi}{2}} \frac{\cos t}{\cos t + \sin t} \, dt
$$

原式是：

$$
I = \int_0^{\frac{\pi}{2}} \frac{\sin x}{\sin x + \cos x} dx
$$

变换后得到：

$$
I = \int_0^{\frac{\pi}{2}} \frac{\cos x}{\sin x + \cos x} dx
$$

所以两者相加：

$$
2I = \int_0^{\frac{\pi}{2}} \left( \frac{\sin x}{\sin x + \cos x} + \frac{\cos x}{\sin x + \cos x} \right) dx = \int_0^{\frac{\pi}{2}} 1 \, dx = \frac{\pi}{2}
$$