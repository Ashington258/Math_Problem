# 微分算子法求解线性常系数非齐次微分方程

## 1. 方法概述

**微分算子法**（Differential Operator Method），又称为**运算子法**，是一种系统求解**线性常系数非齐次微分方程**的方法。该方法尤其适用于右端函数为指数函数、多项式、三角函数，或其线性组合的情形。

设 $D = \tfrac{d}{dx}$，则微分方程可表示为

$$
L(D)y = f(x),
$$

其中 $L(D)$ 为关于 $D$ 的多项式，称为**线性常系数微分算子**，$f(x)$ 为已知非齐次项。


## 2. 基本原理

解的一般形式为

$$
y(x) = y_h(x) + y_p(x),
$$

其中：

- $y_h(x)$：对应齐次方程 $L(D)y = 0$ 的通解；
- $y_p(x)$：对应非齐次方程 $L(D)y = f(x)$ 的一个特解。

利用算子符号，可以形式化地写为

$$
y_p(x) = \frac{1}{L(D)}f(x).
$$

具体计算时，需要根据 $f(x)$ 的类型选择合适的展开或代换方法。


## 3. 常见右端函数的处理方法

### 3.1 指数函数型 $f(x) = e^{\lambda x}$

利用性质

$$
D^n e^{\lambda x} = \lambda^n e^{\lambda x}
\quad \Rightarrow \quad
L(D)e^{\lambda x} = L(\lambda)e^{\lambda x},
$$

可得：

- 若 $L(\lambda) \neq 0$，则
  $$
  y_p = \frac{1}{L(\lambda)}e^{\lambda x}.
  $$

- 若 $L(\lambda) = 0$，即 $e^{\lambda x}$ 属于齐次解，则需改为
  $$
  y_p = x^k \cdot \frac{1}{L^{(k)}(\lambda)}e^{\lambda x}, \quad 
  k = \text{零点的重数}.
  $$



### 3.2 多项式型 $f(x) = P_n(x)$

若 $L(D)$ 无零根（即常数项 $a_0 \neq 0$），则特解 $y_p$ 仍为 $n$ 次多项式：

$$
y_p(x) = A_n x^n + \cdots + A_1 x + A_0,
$$

将其代入方程即可确定系数。  
若 $L(D)$ 有零根，则需在 $y_p(x)$ 前乘以 $x^k$，以保证解的线性无关性。



### 3.3 三角函数型 $f(x) = \sin(\omega x)$ 或 $\cos(\omega x)$

由于

$$
D^2 \sin(\omega x) = -\omega^2 \sin(\omega x),
$$

算子作用可转化为代入 $D^2 = -\omega^2$。  
对于含有奇次算子的情况，可通过引入共轭因子，将其转化为偶次算子。例如：

$$
\begin{aligned}
\frac{1}{D^2 + 2D + 3}\cos x 
&= \frac{1}{2D + 2}\cos x \\[6pt]
&= \tfrac{1}{2}\,\frac{D - 1}{(D+1)(D-1)}\cos x \\[6pt]
&= \tfrac{1}{2}\,\frac{D+1}{D^2 - 1}\cos x \\[6pt]
&= -\tfrac{1}{4}(D+1)\cos x \\[6pt]
&= -\tfrac{1}{4}\bigl(-\sin x + \cos x\bigr).
\end{aligned}
$$

另一种方法是采用指数形式：

$$
L(D)e^{i\omega x} = L(i\omega)e^{i\omega x}.
$$

因此：

- 若 $L(-\omega^2) \neq 0$，则
  $$
  y_p = \frac{1}{L(-\omega^2)}\sin(\omega x) 
  \quad \text{或} \quad 
  y_p = \frac{1}{L(-\omega^2)}\cos(\omega x).
  $$

- 若 $L(-\omega^2) = 0$，即对应于特征方程的根，则应在解中引入 $x^k$ 因子，以确保与齐次解线性无关。



### 3.4 混合型：$e^{\lambda x}P(x)$ 或 $e^{\lambda x}\sin(\omega x)$

处理原则为**因子分离 + 代入 $D \to D+\lambda$**：

- 若 $f(x) = e^{\lambda x}P(x)$，
  $$
  \frac{1}{L(D)}e^{\lambda x}P(x)
  = e^{\lambda x}\cdot \frac{1}{L(D+\lambda)}P(x).
  $$

- 若 $f(x) = e^{\lambda x}\sin(\omega x)$，
  $$
  y_p = e^{\lambda x}\cdot \frac{1}{L(D+\lambda)}\sin(\omega x).
  $$



## 4. 总结表格

| 非齐次项 $f(x)$                      | 特解形式 $y_p$                                         |
| ------------------------------------ | ------------------------------------------------------ |
| $e^{\lambda x}$                      | $\tfrac{1}{L(\lambda)}e^{\lambda x}$，若无效则乘 $x^k$ |
| $P_n(x)$                             | 多项式形式，若与齐次解重复则乘 $x^k$                   |
| $\sin(\omega x)$ 或 $\cos(\omega x)$ | $A\sin(\omega x)+B\cos(\omega x)$，若重复则乘 $x^k$    |
| $e^{\lambda x}P(x)$                  | $e^{\lambda x}\cdot$(多项式形式)                       |
| $e^{\lambda x}\sin(\omega x)$        | $e^{\lambda x}(A\sin\omega x+B\cos\omega x)$           |


## 5. 例题解析

**例题**：求微分方程的特解：

$$
y'' - 3y' + 2y = e^{x}
$$

令：

$$
L(D) = D^2 - 3D + 2
$$

右端为 $e^x$，代入得：

$$
L(D)y_p = e^x \Rightarrow y_p = \frac{1}{L(1)}e^x = \frac{1}{1 - 3 + 2}e^x = \frac{1}{0}e^x
$$

**失败！** 说明 $D=1$ 是特征根（即 $e^x$ 是齐次解），应改用：

$$
y_p = x \cdot \frac{1}{L'(1)}e^x = x \cdot \frac{1}{(2D - 3)'|_{D=1}}e^x = x e^x
$$


1. e.g.1：$y'' + y = \sin x$
2. e.g.2：$y'' - 4y' + 4y = x^2+3x +6$
3. e.g.3：$y'' + y' +3y = xe^x$
4. e.g.4：$y'' + 2y' + 5y = e^{2x}\cos x$




## 例题求解

**e.g.1：$\sin(\omega x)$型**

$$
(D^2+1)y = \sin x
$$

$$
\begin{aligned}
    y_p &= \frac{1}{D^2+1}\sin x\\
    &= \frac{1}{0}\sin x \\
    &= x\cdot \frac{1}{(D^2+1)'}\sin x\\
    &= x\cdot \frac{1}{2D}\sin x\\
    &=- \frac{x\cos x}{2}
\end{aligned}
$$

**e.g.2：$P_m(x)$型**
$$
(D^2-4D+4)y = x^2+3x +6
$$

$$
\begin{aligned}
    y_p &= \frac{1}{D^2-4D+4}(x^2+3x +6)\\
    &= \frac{1}{(D-2)^2}(x^2+3x +6)\\
    &= (\frac{1}{4} + \frac{1}{4}D+\frac{3}{16}D^2\cdots)(x^2+3x +6)\\
    &= \frac{1}{4}(x^2+3x +6)+ \frac{1}{4}(2x +3)+ \frac{3}{16}(2)\\
    &= \frac{1}{4}x^2 + \frac{5}{4}x + \frac{21}{8}
\end{aligned}
$$

**e.g.3：$P_m(x)e^{\lambda x}$型**
$$
(D^2+D+3)y = xe^x
$$

$$
\begin{aligned}
    y_p &= \frac{1}{D^2+D+3}(xe^x)\\
    &= e^x\cdot \frac{1}{(D+1)^2+(D+1)+3}x\\
    &= e^x\cdot \frac{1}{D^2+3D+5}x\\
    &= e^x\cdot (\frac{1}{5}-\frac{3}{25}D\cdots)x\\
    &= e^x(\frac{1}{5}x - \frac{3}{25} )\\
\end{aligned}
$$


**e.g.4：$P_m(x)\sin\omega x$型**
$$
(D^2+2D+5)y = e^{2x}\cos x
$$

$$
\begin{aligned}
    y_p &= \frac{1}{D^2+2D+5}(e^{2x}\cos x)\\
    &= e^{2x}\cdot \frac{1}{(D+2)^2+2(D+2)+5}(\cos x)\\
    &= e^{2x}\cdot \frac{1}{D^2+6D+13}(\cos x)\\
    &\stackrel{\omega^2 = -D^2 = 1}{\;\;=\;\;} e^{2x}\frac{1}{6D+12}\cos x\\
    &= \frac{e^{2x}}{6}\frac{1}{D+2}\cos x\\
    &= \frac{e^{2x}}{6}\frac{D -2}{(D+2)(D-2)}\cos x\\
    &= \frac{e^{2x}}{6}\frac{D-2}{-5}\cos x\\
    &=\frac{-1}{30}e^{2x}(D-2)\cos x\\
    &= \frac{-1}{30}e^{2x}(-\sin x + 2\cos x)\\
    &= \frac{1}{30}e^{2x}(\sin x + \cos x)
\end{aligned}
$$